<?phprequire_once('inc/_init.php');require_once('inc/functions/general.php');if($lghsh['Id'] == 0){	require_once('inc/functions/authorization.php'); 	$pgcontent = logform(); 	}include_once 'inc/functions.php';include_once 'wconfig.php';setlocale(LC_MONETARY, 'en_US');error_reporting(E_ERROR | E_WARNING | E_PARSE);ini_set('memory_limit', '1024M');$subc = $pgcontent = NULL;if(isset($_POST['stchange'])){	$Queue = new QuickBooks_WebConnector_Queue($dsn, $qbwc_user); 	foreach($_POST as $pk=>$pv){		if(preg_match('/^(qb_)([\d]{1,20})(__)(\d)(__)([\d]{0,1})$/', $pk, $m)){			$ac = ($m[4]==0)?1:0;			$newid = ins2amstts($pk, $pv, $ac);			if($newid){				if($m[6]){ $Queue->enqueue(QB_ACT_INVENTORYITEM, $newid); }				else  { $Queue->enqueue(QB_ACT_NONINVENTORYITEM, $newid); }				}			$subc .= $pv.'<br>';			}		}	$pgcontent .= '<div style="float: left;">'.$subc.'</div><div style="float: right; padding-right: 25px;"><a href="qbdeact.php">Go to list</a></div>';	}	else{	$iic = $ii_0 = $ii_1 = $ii_2 = $ii_3 = 0;	$cls = (isset($_POST['itsrch']) AND $_POST['sw']) ? "Title LIKE '%$_POST[sw]%' OR Sku LIKE '%$_POST[sw]%'" : 1;//	$cls = "Title LIKE '%Cubitac%' AND Sku LIKE '%-1230%'";	$orderby = (isset($_GET['ordby']))?$_GET['ordby']:'id';	$asds = (isset($_GET['asds1']))?$_GET['asds1']:'ASC';	// $asds = (isset($_GET['asds2']))?$_GET['asds2']:$asds;	// $asds = (isset($_GET['asds3']))?$_GET['asds3']:$asds;	$result = mysqli_query($dbh, "SELECT * FROM qw_item WHERE $cls ORDER BY $orderby $asds LIMIT 50000");	while($rc = mysqli_fetch_assoc($result)){				$stts=($rc['Active'])?'<span style="color: #060;">ACTIVE</span>':'INACTIVE';		$cbgr=($rc['Active'])?'':'background: #999; color: #fff;';		if($rc['Active']){ $ii_0++;			$stts='<span style="color: #060;">ACTIVE</span>';			}		else{ $ii_1++;			$stts='INACTIVE'; 			}		$subc .= '<tr><td>'.++$iic.'</td><td style="width: 20px; background: '.(($rc['Active'])?'#9f9':'#999').';"><input type="checkbox" name="qb_'.$rc['id'].'__'.$rc['Active'].'__'.$rc['Inv'].'" value="'.$rc['QBListID'].'" /></td><td>'.$rc['Sku'].'</td><td style="color: '.(($rc['Active'])?'#009':'#999').';">'.$rc['Title'].'</td><td style="background: '.(($rc['Inv'])?'#cfc':'#ff9').';">'.(($rc['Inv'])?'Inventory':'Non Inventory').'</td><td style="width: 75px; '.(($rc['Active'])?'':'background: #999; color: #fff;').'">'.(($rc['Active'])?'ACTIVE':'INACTIVE').'</td></tr>';		}//	$asds = ($asds=='ASC')?'DESC':'ASC';$pgtitle = '<h4>QB item status</h4>';//$pgcontent = <<<EOD__$pgcontent = '<!-- Page content start --><style></style><form method="post" name="defrm" action="#"><table class="TBL" width="100%" cellspacing="1"> <tr><th style="width: 3%;"></th><th style="width: 2%;"><input type="checkbox" name="item2sendchkcnt" title="Check/Empty all" value="1" id="chckall" /></th>	<th style="width: 10%;">Sku <div style="float: right;">'.$iic.' items - </div></th>	<th style="width: 500px;">	<input style="float: left;" type="text" name="sw" value="'.$_POST['sw'].'" placeholder="Search for" />	<input style="float: left; padding: 0px 17px;" type="submit" name="itsrch" value="Search" />	Title<div style="float: right;">'.$ii_0.' Active and '.$ii_1.' Inactive Items </div></th>	<th style="width: 5%;">Inventory</div></th>	<th style="width: 10%;">Status <div style="float: right;"><input type="submit" name="stchange" value="Change" /></div></th></tr>'.$subc.'</table></form><script>document.getElementById("chckall").onclick = function() {var checkboxes = document.querySelectorAll(\'input[type="checkbox"]\');for(var checkbox of checkboxes) {	if(!checkbox.disabled){		checkbox.checked = this.checked;		}	}}</script><!-- Page content end -->';}$page_title       = 'Unified Management System - Tool #1';$hsct = 'qbdeactit';$page_description = '';$keywords         = '';$head_ext         = '';	require_once('inc/_shell.php'); ///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////function ins2amstts($k, $v, $act=0){ global $dbh;	$id = preg_replace('/^qb_/','',$k);	$id = preg_replace('/__\d$/','',$id);	$qp = mysqli_query($dbh, "SELECT * FROM qw_item WHERE id='$id' AND QBListID='$v'") or die('Error: ' . mysqli_error($dbh));	$ir = mysqli_fetch_assoc($qp);		$que = "INSERT INTO wc_item ( QBListID, EdSeq, Active, IncAccRef, ExpAccRef ) 		VALUES (			'" . mysqli_escape_string($dbh, $ir['QBListID'] ) . "',			'" . mysqli_escape_string($dbh, $ir['EdSeq'] ) . "',			'" . mysqli_escape_string($dbh, $act ) . "',			'" . mysqli_escape_string($dbh, $ir['IncAccRef'] ) . "',			'" . mysqli_escape_string($dbh, $ir['ExpAccRef'] ) . "'			)";	mysqli_query($dbh, $que);	return mysqli_insert_id($dbh);}////////////////////////////////////////////////////////////////////////////////////////function chckSku_____($sku){ global $dbh;	$q = mysqli_query($dbh, "SELECT id FROM wc_consolisku WHERE Sku_WC='$sku'") or die('Error: ' . mysqli_error($dbh));	return mysqli_num_rows($q);}function ins2csku______($wcsku, $mfx, $pfx, $asm){ global $dbh;							$q = "INSERT INTO wc_consolisku( Sku_WC, Vendor, Sku_2020, Style_2020, Asm	) 							VALUES ( 							'$wcsku',							'GHI',							'$mfx',							'$pfx',							'$asm')";					mysqli_query($dbh, $q) or die("DB update failed: " . mysqli_connect_error());	return;}//////////////////////////////////////////////////////////////////////////////////////////	?>