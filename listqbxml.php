<?phpinclude_once('inc/_init.php');include_once('inc/functions/general.php');error_reporting(E_ALL | E_STRICT);$page_description = '';$keywords         = '';$head_ext         = '';$page_title       = 'Unified WC Terminal';if($lghsh['Id'] == 0){	require_once('inc/functions/authorization.php'); 	$pgcontent = logform(); 	$page_title = 'WC Terminal LogIn';	require_once('inc/_shell.php'); ///	exit;	}include_once 'inc/functions.php';include_once 'inc/local/jstat_f.php';setlocale(LC_MONETARY, 'en_US');$ords = $msg = NULL;include_once 'wconfig.php';$thead = $trows = NULL;$tm = 0;if(isset($_GET['xml'])){	if($_GET['xml']=='nitem'){  /////////////////////////// Display Non Inventory Items XML		$thead = '	<tr><th></th>		<th style="font-size: 13px;" colspan="5">QB Product</th>		<th style="font-size: 13px;" colspan="2">Price</th>		<th style="font-size: 13px;" colspan="2">Account Ref.</th>		<th style="font-size: 13px;" colspan="2">Date / Time</th>	</tr>	<tr><th style="width: 50px;"></th>		<th style="width: 150px;">List ID</th>		<th style="width: 150px;">E-Seq.</th>		<th style="width: 250px;">Sku</th>		<th style="width: 700px;">Title</th>		<th style="width: 150px;">Vendor</th>		<th style="width: 70px;">Cost</th>		<th style="width: 70px;">Sale</th>		<th style="width: 130px;">Income</th>		<th style="width: 130px;">Expence</th>		<th style="width: 130px;">DT created</th>		<th style="width: 130px;">DT modified</th>	</tr>';		$fn = NI_ITEMS_XML;		if (!file_exists($fn)) { die("XML file not found"); }		$xml = simplexml_load_file($fn);		foreach($xml->QBXMLMsgsRs->ItemNonInventoryQueryRs->ItemNonInventoryRet as $d){ $tm++;			$tcreat = substr($d->TimeCreated,  0, 19);			$tmodif = substr($d->TimeModified, 0, 19);			$trows .= '	<tr><td>' . $tm.' . </td>		<td>' . $d->ListID . '</td>		<td>' . $d->EditSequence . '</td>		<td>' . $d->Name . '</td>		<td>' . $d->SalesAndPurchase->SalesDesc . '</td>		<td>' . (($d->SalesAndPurchase->PrefVendorRef)? $d->SalesAndPurchase->PrefVendorRef->FullName:NULL) . '</td>		<td>' . $d->SalesAndPurchase->PurchaseCost . '</td>		<td>' . $d->SalesAndPurchase->SalesPrice . '</td>		<td nowrap>' . (($d->SalesAndPurchase->IncomeAccountRef)?$d->SalesAndPurchase->IncomeAccountRef->FullName:NULL) . '</td>		<td nowrap>' . (($d->SalesAndPurchase->ExpenseAccountRef)?$d->SalesAndPurchase->ExpenseAccountRef->FullName:NULL) . '</td>		<td>' . $tcreat . '</td>		<td>' . $tmodif . '</td>	</tr>';			}		}	if($_GET['xml']=='iitem'){   ///////////////////////////    Display Inventory Items XML		$thead = '	<tr><th></th>		<th style="font-size: 13px;" colspan="5">QB Product</th>		<th style="font-size: 13px;" colspan="2">Price</th>		<th style="font-size: 13px;" colspan="2">Account Ref.</th>		<th style="font-size: 13px;" colspan="2">Date / Time</th>	</tr>	<tr><th style="width: 50px;"></th>		<th style="width: 150px;">List ID</th>		<th style="width: 150px;">E-Seq.</th>		<th style="width: 250px;">Sku</th>		<th style="width: 700px;">Title</th>		<th style="width: 150px;">Vendor</th>		<th style="width: 70px;">Cost</th>		<th style="width: 70px;">Sale</th>		<th style="width: 130px;">Income</th>		<th style="width: 130px;">Expence</th>		<th style="width: 130px;">DT created</th>		<th style="width: 130px;">DT modified</th>	</tr>';		$fn = I_ITEMS_XML;		if (!file_exists($fn)) { die("XML file not found"); }		$xml = simplexml_load_file($fn);		foreach($xml->QBXMLMsgsRs->ItemInventoryQueryRs->ItemInventoryRet as $d){ $tm++;			$tcreat = substr($d->TimeCreated,  0, 19);			$tmodif = substr($d->TimeModified, 0, 19);			$trows .= '	<tr><td>' . $tm.' . </td>		<td style="width: 200px;">' . $d->ListID . '</td>		<td style="width: 70px;">' . $d->EditSequence . '</td>		<td>' . $d->Name . '</td>		<td>' . $d->SalesDesc . '</td>		<td>' . (($d->PrefVendorRef)? $d->PrefVendorRef->FullName:NULL) . '</td>		<td>' . $d->PurchaseCost . '</td>		<td>' . $d->SalesPrice . '</td>		<td nowrap>' . (($d->IncomeAccountRef)?$d->IncomeAccountRef->FullName:NULL) . '</td>		<td nowrap>' . (($d->COGSAccountRef)?$d->COGSAccountRef->FullName:NULL) . '</td>		<td>' . $tcreat . '</td>		<td>' . $tmodif . '</td>	</tr>';			}		}	if($_GET['xml']=='cst'){  ///////////////////////////        Display Customers XML		$thead = '	<tr><th colspan="2"></th>		<th style="font-size: 13px;" colspan="4">QB Customer</th>		<th style="font-size: 13px;" colspan="2">Date / Time</th>	</tr>	<tr><th style="width: 50px;"></th>		<th style="width: 120px;">List ID</th>		<th style="width: 250px;">Company</th>		<th style="width: 200px;">Name</th>		<th style="width: 150px;">Phone</th>		<th style="width: 70px;">Email</th>		<th style="width: 120px;">DT created</th>		<th style="width: 120px;">DT modified</th>	</tr>';		$fn = QB_CUSTOMER_XML;		if (!file_exists($fn)) { die("XML file not found"); }				$xml = simplexml_load_file($fn);		foreach($xml->QBXMLMsgsRs->CustomerQueryRs->CustomerRet as $d){ $tm++;			$tcreat = substr($d->TimeCreated,  0, 19);			$tmodif = substr($d->TimeModified, 0, 19);			$trows .= '	<tr><td>' . $tm.' . </td>		<td>' . $d->ListID . '</td>		<td>' . $d->FullName . '</td>				<td>' . $d->LastName . ', ' . $d->FirstName . '</td>		<td>' . $d->Phone . '</td>		<td>' . $d->Email . '</td>				<td>' . $tcreat . '</td>		<td>' . $tmodif . '</td>	</tr>';			}		}			if($_GET['xml']=='so'){  ///////////////////////////        Display Sales Order XML		$thead = '	<tr><th colspan="2"></th>		<th style="font-size: 13px;" colspan="2">Sales Order</th>		<th style="font-size: 13px;" colspan="2">Date / Time</th>	</tr>	<tr><th style="width: 50px;"></th>		<th style="width: 70px;">Order ID</th>		<th style="width: 70px;">Total</th>		<th>Name</th>		<th style="width: 120px;">DT created</th>		<th style="width: 120px;">DT modified</th>	</tr>';		$fn = SALES_ORDER_XML;		if (!file_exists($fn)) { die("XML file not found"); }				$xml = simplexml_load_file($fn);		foreach($xml->QBXMLMsgsRs->SalesOrderQueryRs->SalesOrderRet as $d){ $tm++;			$infdb  = (($lghsh['Prvlg'] == 'A' OR $lghsh['Prvlg'] == 'B') AND chckdb_jstt($d->RefNumber))?'<a style="float: right;" href="dispajob.php?oid='.$d->RefNumber.'" OnClick="return load_console(this.href, \'1100px\', \'90%\');">Job Info</a>':'';			$tcreat = substr($d->TimeCreated,  0, 19);			$tmodif = substr($d->TimeModified, 0, 19);			$trows .= '	<tr><td>' . $tm.' . </td>		<td><a href="dispxml.php?oid='.$d->RefNumber.'" DOnClick="return load_console(this.href, \'500px\', \'90%\');">' . $d->RefNumber . '</a></td>		<td style="text-align: right; background: #ffd; padding: 0px 7px;">' . (number_format(floatval($d->TotalAmount), 2)) . '</td>		<td>' . $d->CustomerRef->FullName . ' '.$infdb.'</td>		<td>' . $tcreat . '</td>		<td>' . $tmodif . '</td>	</tr>';			}		}	}			$pcnt = '<form method="post" action="listqbxml.php" name="DForm"><div style="margin-top: 25px;"><!-- div style="float: left;">&nbsp; &nbsp;<input type="button" name="xmlreq" value="Request XML" style="padding: 1px 5px;" OnClick="return requestqbinventoryxml();" /> &nbsp; &nbsp;</div><div style="float: right;">&nbsp; &nbsp;<input type="Submit" name="updb" value="Update DB" style="padding: 1px 5px;" /> &nbsp; &nbsp;</div --><div style="clear: both;"></div></div><table class="TBL" width="100%" cellspacing="1">'.$thead.''.$trows.'</table></form><script>function requestqbinventoryxml(){var url = "qbinventoryquery.php";var prt = perform(url); 	if(prt){alert(prt);}//	else{window.location.reload();}	return false;}function load_console(url, wd, ht){ //alert(url); return false;var	obj = document.getElementById("CConsole");var	pln = document.getElementById("consolink");	pln.href = url+"&cns=pf";	obj.style.display = "block";	obj.style.width = wd;	obj.style.height = ht;	query_srv(url, \'InConsole\');	return false;}function ClsConsole(){	document.getElementById("CConsole").style.display = "none";	return;}</script>';$pgtitle = '<h4>List</h4>';$pgcontent = <<<EOD__<!-- Page content start -->$pcnt<!-- Page content end -->EOD__;require_once('inc/_shell.php'); /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////?>